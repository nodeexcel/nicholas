{"version":3,"sources":["../../src/controllers/imageProcess.js"],"names":["AdmZip","require","Kraken","UserController","uploadImage","req","res","next","kraken","console","log","params","url","wait","lossy","status","success","kraked_url","message","controller"],"mappings":";;;;;;;AAAA;;;;AACA;;;;AAEA;;;;AACA;;;;;;;;;;;;AAFA,IAAIA,SAASC,QAAQ,SAAR,CAAb;;AAGA,IAAIC,SAASD,QAAQ,QAAR,CAAb;;IAEaE,c,WAAAA,c;;;;;;;;;;;;;;0MAETC,W,GAAc,UAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAC9B,gBAAIC,SAAS,IAAIN,MAAJ,CAAW;AACpB,2BAAW,kCADS;AAEpB,8BAAc;AAFM,aAAX,CAAb;AAIAO,oBAAQC,GAAR,CAAY,iBAAZ;AACA,gBAAIC,SAAS;AACTC,qBAAK,gCADI;AAETC,sBAAM,IAFG;AAGTC,uBAAO;AAHE,aAAb;AAKAL,oBAAQC,GAAR,CAAYC,MAAZ;;AAEAH,mBAAOI,GAAP,CAAWD,MAAX,EAAmB,UAASI,MAAT,EAAiB;AAChCN,wBAAQC,GAAR,CAAY,yCAAZ;AACA,oBAAIK,OAAOC,OAAX,EAAoB;AAChBP,4BAAQC,GAAR,CAAY,kCAAZ,EAAgDK,OAAOE,UAAvD;AACH,iBAFD,MAEO;AACHR,4BAAQC,GAAR,CAAY,yBAAZ,EAAuCK,OAAOG,OAA9C;AACH;AACJ,aAPD;;AASA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AAEH,S;;;;;;AAIL,IAAMC,aAAa,IAAIhB,cAAJ,EAAnB;kBACegB,U","file":"imageProcess.js","sourcesContent":["import BaseAPIController from \"./BaseAPIController\";\nimport db from '../db.js'\nvar AdmZip = require('adm-zip');\nimport fs from \"fs\";\nimport formidable from \"formidable\";\nvar Kraken = require(\"kraken\");\n\nexport class UserController extends BaseAPIController {\n\n    uploadImage = (req, res, next) => {\n        var kraken = new Kraken({\n            \"api_key\": \"ba861f2d7b7e398cefeb106ecdce58d7\",\n            \"api_secret\": \"1a61f223803ed78b6cdd429511215aa3a6e82607\"\n        });\n        console.log(\"]]]]]]]]]]]]]]]\")\n        var params = {\n            url: \"http://localhost:5001/msd1.jpg\",\n            wait: true,\n            lossy: true\n        };\n        console.log(params)\n\n        kraken.url(params, function(status) {\n            console.log(\"=======================================\")\n            if (status.success) {\n                console.log(\"Success. Optimized image URL: %s\", status.kraked_url);\n            } else {\n                console.log(\"Fail. Error message: %s\", status.message);\n            }\n        });\n\n        // reading archives\n        // console.log(\"=======================\")\n        // let form = new formidable.IncomingForm();\n        // form.parse(req, function(err, fields, files) {\n        //     // let new_path = path.join(__dirname, files.file.name);\n        //     fs.readFile(files.file.path, function(err, data) {\n        //         // response.pipe(file);\n        //         // console.log(data.toString('utf8'), \"kkkkkkkkkkkkkkkkkkkkk\")\n        //     })\n        // })\n        // var zip = new AdmZip(\"/var/www/html/msdpics.zip\");\n        // var zipEntries = zip.getEntries(); // an array of ZipEntry records\n        // zipEntries.forEach(function(zipEntry) {\n        //     if (!zipEntry.isDirectory) {\n        //         // console.log(zipEntry.toString(), \"============================\"); // outputs zip entries information\n        //         console.log(zipEntry.name, \"============================\"); // outputs zip entries information\n        //     }\n        // });\n\n        // zip.extractAllTo( /*target path*/ \"/home/etech\", /*overwrite*/ true);\n        // fs.unlink('/home/etech/msdpics', function() {\n        //     console.log(\"success\");\n        //     res.json(\"success\")\n        // });\n\n    }\n\n}\n\nconst controller = new UserController();\nexport default controller;"]}